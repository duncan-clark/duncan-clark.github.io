gwesp(0.000001)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
summary(lolog_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ degree(0:100))
plot(gof_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ esp(0:30))
plot(gof_5)
cl <- parallel::makeCluster(3)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
#gwdegree(0.001)+
gwesp(0.000001)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
summary(lolog_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ degree(0:100))
plot(gof_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ esp(0:30))
plot(gof_5)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
#gwdegree(0.001)+
esp(0:3)
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
cl <- parallel::makeCluster(3)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
#gwdegree(0.001)+
esp(0:3)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
cl <- parallel::makeCluster(3)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
#gwdegree(0.001)+
gwesp(0.0001)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
summary(lolog_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ degree(0:100))
plot(gof_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ esp(0:30))
plot(gof_5)
cl <- parallel::makeCluster(3)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
gwdegree(0.001)+
gwesp(0.0000001)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
summary(lolog_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ degree(0:100))
plot(gof_5)
gof_5 <- lolog::gofit(lolog_5,ucla_net_undir ~ esp(0:30))
plot(gof_5)
e*(0.000001)
exp(0.000001)
exp(0.000001)**10
exp(0.000001)**100
(exp(0.000001))**10
(exp(0.000001))**100
(exp(0.000001))**1000
(exp(0.000001))**10000
(exp(0.000001))**100000
(exp(0.000001))**1000000
(exp(0.000001))**10000000
cl <- parallel::makeCluster(3)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
gwdegree(0.001)+
triangles+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
View(lolog_2)
lolog_5 <- lolog(ucla_net_undir ~ #edges +
#preferentialAttachment()+
#gwdegree(0.001)+
esp(0:3)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
#gwdegree(0.001)+
esp(0:3)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
#gwdegree(0.001)+
esp(1:3)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
lolog_5 <- lolog(ucla_net_undir ~ edges +
#preferentialAttachment()+
gwdegree(0.001)+
gwesp(0.0000001)+
nodeCov("month_mean_hours")
#ucla_net_undir ~ star(2)
,
cluster = cl
)
rm(list=ls())
load("~/Academics/R/R_Projects/Strava_Net/.RData")
summary(ucla_net,print.adj = F)
getwd()
help(plot.network)
cor(degree,dists)
names = get.vertex.attribute(ucla_net,"names")
odegree = rowSums(as.matrix.network.adjacency(ucla_net))
idegree = colSums(as.matrix.network.adjacency(ucla_net))
degree = colSums(as.matrix.network.adjacency(ucla_net)) + rowSums(as.matrix.network.adjacency(ucla_net))
ids = get.vertex.attribute(ucla_net,"id")
dists = get.vertex.attribute(ucla_net,"month_mean_dist")
elev = get.vertex.attribute(ucla_net,"month_mean_elev_gain")
hours = get.vertex.attribute(ucla_net,"month_mean_hours")
cor(dists,elev)
cor(dists,hours)
cor(elev,hours)
cor(degree,dists)
#Replace Nas with 0s for the attributes:
for(i in list.vertex.attributes(ucla_net)){
tmp = get.vertex.attribute(ucla_net,i)
tmp[is.na(tmp)] <- 0
set.vertex.attribute(ucla_net,i,tmp)
}
#do some plots:
names = get.vertex.attribute(ucla_net,"names")
odegree = rowSums(as.matrix.network.adjacency(ucla_net))
idegree = colSums(as.matrix.network.adjacency(ucla_net))
degree = colSums(as.matrix.network.adjacency(ucla_net)) + rowSums(as.matrix.network.adjacency(ucla_net))
ids = get.vertex.attribute(ucla_net,"id")
dists = get.vertex.attribute(ucla_net,"month_mean_dist")
elev = get.vertex.attribute(ucla_net,"month_mean_elev_gain")
hours = get.vertex.attribute(ucla_net,"month_mean_hours")
cor(dists,elev)
cor(dists,hours)
cor(elev,hours)
cor(degree,dists)
for(i in list.vertex.attributes(ucla_net)){
tmp = get.vertex.attribute(ucla_net,i)
tmp[is.na(tmp)] <- 0
set.vertex.attribute(ucla_net,i,tmp)
}
library(statnet)
library(lolog)
for(i in list.vertex.attributes(ucla_net)){
tmp = get.vertex.attribute(ucla_net,i)
tmp[is.na(tmp)] <- 0
set.vertex.attribute(ucla_net,i,tmp)
}
names = get.vertex.attribute(ucla_net,"names")
odegree = rowSums(as.matrix.network.adjacency(ucla_net))
idegree = colSums(as.matrix.network.adjacency(ucla_net))
degree = colSums(as.matrix.network.adjacency(ucla_net)) + rowSums(as.matrix.network.adjacency(ucla_net))
ids = get.vertex.attribute(ucla_net,"id")
dists = get.vertex.attribute(ucla_net,"month_mean_dist")
elev = get.vertex.attribute(ucla_net,"month_mean_elev_gain")
hours = get.vertex.attribute(ucla_net,"month_mean_hours")
cor(degree,dists)
cor(degree,dists)
tmp = data.frame(degree = degree)
plot <- ggplot(tmp)+
geom_histogram()
library(ggplot2)
tmp = data.frame(degree = degree)
plot <- ggplot(tmp)+
geom_histogram()
tmp
plot(tmp)
tmp = data.frame(degree = degree)
plot <- ggplot(tmp,aes(x=degree))+
geom_histogram()
tmp
plot(tmp)
tmp = data.frame(degree = degree)
plot <- ggplot(tmp,aes(x=degree))+
geom_bar()
tmp
plot(tmp)
tmp
tmp = data.frame(degree = degree)
plot <- ggplot(tmp,aes(x=degree))+
geom_histogram()
head(tmp)
ggplot(tmp,aes(x=degree))+
geom_histogram()
tmp = data.frame(degree = degree)
p<-ggplot(tmp,aes(x=degree))+
geom_histogram()
p
library(ggduncan)
tmp = data.frame(degree = degree)
p<-ggplot(tmp,aes(x=degree))+
geom_histogram()+
scale_colour_duncan()
p
tmp = data.frame(degree = degree)
p<-ggplot(tmp,aes(x=degree))+
geom_histogram()+
scale_fill_duncan()
p
p
scale_fill_duncan()
p<-ggplot(tmp,aes(x=degree))+
geom_histogram()+
theme_duncan()
p
tmp = data.frame(degree = degree,fill=1)
p<-ggplot(tmp,aes(x=degree,fill=))+
geom_histogram()+
theme_duncan()+
scale_fill_duncan()+
theme(legend.title = element_blank())
p
p
p
tmp = data.frame(degree = degree,fill=1)
p<-ggplot(tmp,aes(x=degree,fill=fill))+
geom_histogram()+
theme_duncan()+
scale_fill_duncan()+
theme(legend.title = element_blank())
p
tmp = data.frame(degree = degree,fill=as.factor(1))
p<-ggplot(tmp,aes(x=degree,fill=fill))+
geom_histogram()+
theme_duncan()+
scale_fill_duncan()+
theme(legend.title = element_blank())
p
tmp = data.frame(degree = degree,fill=as.factor(1))
p<-ggplot(tmp,aes(x=degree,fill=fill))+
geom_histogram()+
theme_duncan()+
scale_fill_duncan()+
guides(fill=FALSE)
p
esp <- lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
esp
hist(esp)
plot(esp)
esp <- lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
esp <- do.call(c,mapply(seq(1,length(esp)),esp,FUN = function(x,y){rep(x,times=y)}))
esp
hist(esp)
esp <- lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
esp <- do.call(c,mapply(seq(1,length(esp)),esp,FUN = function(x,y){rep(x,times=y)}))
tmp = data.frame(esp = esp,fill=as.factor(1))
p<-ggplot(tmp,aes(x=esp,fill=fill))+
geom_histogram()+
theme_duncan()+
scale_fill_duncan()+
guides(fill=FALSE)+
geom_title("UCLA Cycling Team ESP Distribution")
p
p
esp <- lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
esp <- do.call(c,mapply(seq(1,length(esp)),esp,FUN = function(x,y){rep(x,times=y)}))
tmp = data.frame(esp = esp,fill=as.factor(1))
p<-ggplot(tmp,aes(x=esp,fill=fill))+
geom_histogram()+
theme_duncan()+
scale_fill_duncan()+
guides(fill=FALSE)+
ggtitle("UCLA Cycling Team ESP Distribution")
p
esp <- lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
esp <- do.call(c,mapply(seq(1,length(esp)),esp,FUN = function(x,y){rep(x,times=y)}))
tmp = data.frame(esp = esp,fill=as.factor(1))
p<-ggplot(tmp,aes(x=esp,fill=fill))+
geom_histogram(binwidth = 2)+
theme_duncan()+
scale_fill_duncan()+
guides(fill=FALSE)+
ggtitle("UCLA Cycling Team ESP Distribution")
p
eig <- evcent(ucla_net,gmode = "graph")
eig
library(reshape2)
eig <- evcent(ucla_net,gmode = "graph")
closn <- closeness(ucla_net,gmode = "graph")
betwn <- betweenness(ucla_net,gmode = "graph")
tmp <- data.frame(eigen_value = eig,closeness = closn,betweenness =betwn)
tmp <- reshape2::melt(tmp)
head(tmp)
p <- ggplot(tmp,aes(x= value,col = varaible))+
facet_grid(~variable)
ggtitle("Plot of the Centraltiy Measures Distributions")+
theme_duncan()+
scale_fill_duncan()
p
p <- ggplot(tmp,aes(x= value,col = variable))+
facet_grid(~variable)
ggtitle("Plot of the Centraltiy Measures Distributions")+
theme_duncan()+
scale_fill_duncan()
p
head(tmp)
p <- ggplot(tmp,aes(x= value,col = variable))+
facet_grid(~variable)+
geom_histogram()+
ggtitle("Plot of the Centraltiy Measures Distributions")+
theme_duncan()+
scale_fill_duncan()
p
p <- ggplot(tmp,aes(x= value,fill = variable))+
facet_grid(~variable)+
geom_histogram()+
ggtitle("Plot of the Centraltiy Measures Distributions")+
theme_duncan()+
scale_fill_duncan()
p
eig <- evcent(ucla_net,gmode = "graph")
closn <- closeness(ucla_net,gmode = "graph")
betwn <- betweenness(ucla_net,gmode = "graph")
tmp <- data.frame(eigen_value = eig,closeness = closn,betweenness =betwn)
tmp <- reshape2::melt(tmp)
p <- ggplot(tmp,aes(x= value,fill = variable))+
facet_wrap(~variable,scales = "free")+
geom_histogram()+
ggtitle("Plot of the Centraltiy Measures Distributions")+
theme_duncan()+
scale_fill_duncan()
p
summary(closn)
closn
closn <- closeness(ucla_net,gmode = "graph")
closn
help(closeness)
plot(ucla_net)
closn <- closeness(ucla_net,gmode = "digraph")
closn
closn <- closeness(ucla_net,gmode = "graph")
closn
debug(closeness)
closn <- closeness(ucla_net,gmode = "graph")
cmode
dat
gd
dim(gd_)
dim(gd)
length(gd)
class(gd)
dg[[1]]
gd[[1]]
clo
help(switch)
rowSums(gd$gdist,
na.rm = TRUE)
gd$gdist
rowSums(gd$gdist,
na.rm = TRUE)
plot(ucla)
plot(ucla_net
)
#for closeness need largest connected component:
largest_comp <- function(network){
tmp <- component.dist(network)
comp <- which(tmp$csize == max(tmp$csize))
delete = which(tmp$membership != comp)
network <- delete.vertices(network, vid = delete)
return(network)
}
ucla_net_conn <- largest_comp(ucla_net)
eig <- evcent(ucla_net_conn,gmode = "graph")
closn <- closeness(ucla_net_conn,gmode = "graph")
undebug(closeness)
closn <- closeness(ucla_net_conn,gmode = "graph")
betwn <- betweenness(ucla_net_conn,gmode = "graph")
closn
tmp <- data.frame(eigen_value = eig,closeness = closn,betweenness =betwn)
tmp <- reshape2::melt(tmp)
p <- ggplot(tmp,aes(x= value,fill = variable))+
facet_wrap(~variable,scales = "free")+
geom_histogram()+
ggtitle("Plot of the Centraltiy Measures Distributions")+
theme_duncan()+
scale_fill_duncan()
p
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = TRUE)
knitr::opts_chunk$set(cache = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "100%")
library(ggplot2)
library(ggduncan)
library(rStrava)
library(statnet)
library(rvest)
library(lolog)
library(ggduncan)
library(reshape2)
load("UCLA_net_data.Rdata")
esp <- lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
lolog::calculateStatistics(ucla_net ~ esp(seq(1,50)))
summary(ucla_net,print.adj = F)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = TRUE)
knitr::opts_chunk$set(cache = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "100%")
library(ggplot2)
library(ggduncan)
library(rStrava)
library(statnet)
library(rvest)
library(lolog)
library(ggduncan)
library(reshape2)
load("UCLA_net_data.Rdata")
plot(ucla_net)
lolog::calculateStatistics(ucla_net~esp(c(1,2,3)))
getwd()
#---- UCLA Network -------#
# t <- proc.time()
# ucla_net = scrape_net("ucla-cycling-team",email = "duncan-clark@hotmail.co.uk",password = "Graham01*")
# t <- proc.time()- t
# print(t)
setwd("C:/Users/Duncan/Documents/Academics/R/R_Projects/Strava_Net")
load("UCLA_net_data.Rdata")
getwd()
list.files()
load("UCLA_net_data.Rdata")
lolog::calculateStatistics(ucla_net~esp(c(1,2,3)))
lolog::calculateStatistics(ucla_net~esp())
summary(ucla_net,print.adj = F)
lolog::calculateStatistics(ucla_net~esp(seq(1,183)))
for(i in list.vertex.attributes(ucla_net)){
tmp = get.vertex.attribute(ucla_net,i)
tmp[is.na(tmp)] <- 0
set.vertex.attribute(ucla_net,i,tmp)
}
lolog::calculateStatistics(ucla_net~esp(seq(1,183)))
eig_net <- net_centralization(ucla_net_conn,evcent)
closn_net <- net_centralization(ucla_net_conn,closeness)
betwn_net <- net_centralization(ucla_net_conn,betweeness)
net_centralization <- function(net,func){
sum(centralization(net,FUN = func,normalize = TRUE))
}
eig_net <- net_centralization(ucla_net_conn,evcent)
closn_net <- net_centralization(ucla_net_conn,closeness)
betwn_net <- net_centralization(ucla_net_conn,betweeness)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = TRUE)
knitr::opts_chunk$set(cache = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "100%")
library(ggplot2)
library(ggduncan)
library(rStrava)
library(statnet)
library(rvest)
library(lolog)
library(ggduncan)
library(reshape2)
load("UCLA_net_data.Rdata")
#Replace Nas with 0s for the attributes:
for(i in list.vertex.attributes(ucla_net)){
tmp = get.vertex.attribute(ucla_net,i)
tmp[is.na(tmp)] <- 0
set.vertex.attribute(ucla_net,i,tmp)
}
betwn_net <- net_centralization(ucla_net_conn,betweenness)
eig_net <- net_centralization(ucla_net_conn,evcent)
closn_net <- net_centralization(ucla_net_conn,closeness)
betwn_net <- net_centralization(ucla_net_conn,betweenness)
eig_net
closn_net
betwn_net
rm(list=ls())
setwd("C:/Users/Duncan/Documents/duncan-clark.github.io")
source('~/duncan-clark.github.io/R/build.R', echo=TRUE)
setwd("C:/Users/Duncan/Documents/duncan-clark.github.io")
source('~/duncan-clark.github.io/R/build.R', echo=TRUE)
setwd("C:/Users/Duncan/Documents/duncan-clark.github.io")
source('~/duncan-clark.github.io/R/build.R', echo=TRUE)
